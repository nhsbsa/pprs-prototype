{% extends 'layout.html' %}

{% block pageTitle %}
Quarterly collection dropdown - expander list
{% endblock %}

{% block content %}
<div class="nhsuk-back-link">

    <a class="nhsuk-back-link__link nhsuk-u-margin-bottom-5" href="main-suppliers" id="back-link">
        <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
            <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
        </svg>
        Go back to main suppliers</a>
</div>

<!--<div class="nhsuk-grid-row">-->
<!--    <label for="expanderToggle">Expander/Accordion toggle</label>-->
<!--    <input type="checkbox" id="expanderToggle" />-->
<!--    <div class="nhsuk-grid-column-full">-->
        <h1><span class="nhsuk-caption-l">
     October 2023 - 4th request
     <span class="nhsuk-u-visually-hidden">: </span>
   </span>AAH Pharmaceuticals Ltd</h1>

<div class="nhsuk-tabs" data-module="nhsuk-tabs">
    <h2 class="nhsuk-tabs__title">Contents</h2>
    <ul class="nhsuk-tabs__list">
        <li class="nhsuk-tabs__list-item nhsuk-tabs__lt-item--selected"
            id="heading-tab-products"
            role="presentation"><a class="nhsuk-tabs__tab" href="#tab-products" role="tab"
                                   id="products-panel" aria-selected="true">Requested products</a>
        </li>
        <li class="nhsuk-tabs__list-item" id="heading-tab-template" role="presentation"><a
                class="nhsuk-tabs__tab" href="#tab-template" role="tab" id="template-panel">Send template</a></li>
        <li class="nhsuk-tabs__list-item" id="heading-tab-correspondence" role="presentation"><a
                class="nhsuk-tabs__tab" href="#tab-correspondence" role="tab" id="correspondence-panel">Correspondence</a>
        </li>
        <li class="nhsuk-tabs__list-item" id="heading-tab-contact" role="presentation"><a
                class="nhsuk-tabs__tab" href="#tab-contact" role="tab" id="contact-panel">Contact details</a>
        </li>
    </ul>

    <div class="nhsuk-tabs__panel" id="tab-products" role="tabpanel" tabindex="-1"
         aria-labelledby="tab1">
        <div class="nhsuk-tabs-panel-inner">

                    <h2>Requested products</h2>
                    <p>As AAH Pharmaceuticals Ltd is a main supplier, every product in the product list will be present in the template. </p>
            <p><a class="nhsuk-link nhsuk-link--no-visited-state" href="#tab-template">Go to send template</a></p>
        </div>
    </div>
    <div class="nhsuk-tabs__panel" id="tab-template" role="tabpanel" tabindex="-1"
         aria-labelledby="tab1">
        <div class="nhsuk-tabs-panel-inner">

                    <h2>Send template</h2>

                    <p>If you do not need to change the template then you can continue to send via the link below. The correspondence will be updated automatically.</p>

            <div class="nhsuk-action-link nhsuk-u-margin-top-5">
                <a class="nhsuk-action-link__link nhsuk-link--no-visited-state" href="../auto-email/choose-main-suppliers">
                    <svg class="nhsuk-icon nhsuk-icon__arrow-right-circle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="36" height="36">
                        <path d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M12 2a10 10 0 0 0-9.95 9h11.64L9.74 7.05a1 1 0 0 1 1.41-1.41l5.66 5.65a1 1 0 0 1 0 1.42l-5.66 5.65a1 1 0 0 1-1.41 0 1 1 0 0 1 0-1.41L13.69 13H2.05A10 10 0 1 0 12 2z"></path>
                    </svg>
                    <span class="nhsuk-action-link__text">Send an email</span>
                </a>
            </div>

                    <p>If changes need to be made to the template then download, make changes and send via your own email.</p>

                    <a class="nhsuk-button nhsuk-button--secondary nhsuk-u-margin-bottom-6" href="#">Download main supplier template</a>

            <p>If this has been sent via your own email, you must <a class="nhsuk-link nhsuk-link--no-visited-state" href="#tab-correspondence">update the correspondence</a></p>
        </div>
    </div>

    <div class="nhsuk-tabs__panel" id="tab-correspondence" role="tabpanel" tabindex="-1"
         aria-labelledby="tab2">
        <div class="nhsuk-tabs-panel-inner">

                            <h2 class="nhsuk-u-margin-bottom-6">Correspondence</h2>

            <!--<details class="nhsuk-details nhsuk-expander hide-question" id="yes-first-question-expander">-->
            <!--    <summary class="nhsuk-details__summary">-->
            <!--    <span class="nhsuk-details__summary-text" id="yes-first-question">-->
            <!--      Get your medical records-->
            <!--    </span>-->
            <!--    </summary>-->
            <!--    <div class="nhsuk-details__text">-->
            <div id="yes-first-question-expander" class="hide-question">
<!--                <h3>Template sent</h3>-->
                <dl class="nhsuk-summary-list nhsuk-summary-list--no-border">

                    <div class="nhsuk-summary-list__row">
                        <dt class="nhsuk-summary-list__key">
                            Template sent by
                        </dt>
                        <dd class="nhsuk-summary-list__value">
                            Heather Kirk (HEKIR)
                        </dd>
                    </div>

                    <div class="nhsuk-summary-list__row" id="template-sent-list">
                        <dt class="nhsuk-summary-list__key">
                            Date template sent
                        </dt>
                        <dd class="nhsuk-summary-list__value">
                            23 September 2023 at 2pm
                        </dd>
                    </div>
                </dl>
<!--                <p id="yes-first-question-detail">Yes, template sent by Heather on 21 September 2023 at 2.20pm.</p>-->
            </div>

            <!--    </div>-->
            <!--</details>-->
            <!--<details class="nhsuk-details nhsuk-expander hide-question" >-->
            <!--    <summary class="nhsuk-details__summary">-->
            <!--    <span class="nhsuk-details__summary-text" id="yes-second-question">-->
            <!--      Get your medical records-->
            <!--    </span>-->
            <!--    </summary>-->
            <!--    <div class="nhsuk-details__text">-->
            <div class="hide-question" id="yes-second-question-expander">
                <h3>Has the main supplier replied?</h3>
                <p id="yes-second-question-detail">Email received to Heather on 21 September 2023 at 2.20pm.</p>
            </div>

            <!--    </div>-->
            <!--</details>-->



            <div class="nhsuk-form-group">

                <fieldset class="nhsuk-fieldset" id="first-question">
                    <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                        <h3 class="nhsuk-fieldset__heading">
                            Has the template been sent to the supplier?
                        </h3>
                    </legend>

                    <div class="nhsuk-radios nhsuk-radios--inline">

                        <div class="nhsuk-radios__item">
                            <input class="nhsuk-radios__input" id="example-inline-1" name="example-inline" type="radio" value="yes">
                            <label class="nhsuk-label nhsuk-radios__label" for="example-inline-1">
                                Yes
                            </label>
                        </div>

                        <div class="nhsuk-radios__item">
                            <input class="nhsuk-radios__input" id="example-inline-2" name="example-inline" type="radio" value="no">
                            <label class="nhsuk-label nhsuk-radios__label" for="example-inline-2">
                                No
                            </label>
                        </div>

                    </div>
                </fieldset>

                <div class="hide-question" id="second-question">
                    <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-5">
                        <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                            <h3 class="nhsuk-fieldset__heading">
                                Has the main supplier sent a reply?
                            </h3>
                        </legend>

                        <div class="nhsuk-radios nhsuk-radios--inline">

                            <div class="nhsuk-radios__item">
                                <input class="nhsuk-radios__input" id="example-inline-3" name="example-inline-1" type="radio" value="yes">
                                <label class="nhsuk-label nhsuk-radios__label" for="example-inline-3">
                                    Yes
                                </label>
                            </div>

                            <div class="nhsuk-radios__item">
                                <input class="nhsuk-radios__input" id="example-inline-4" name="example-inline-1" type="radio" value="no">
                                <label class="nhsuk-label nhsuk-radios__label" for="example-inline-4">
                                    No
                                </label>
                            </div>

                        </div>
                    </fieldset>


                <fieldset class="nhsuk-fieldset nhsuk-u-margin-top-5" id="third-question">
                    <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--m">
                        <h1 class="nhsuk-fieldset__heading" id="reminder-sent-question">
                            Have you sent a reminder to the supplier for a response?
                        </h1>
                    </legend>

                    <div class="nhsuk-radios nhsuk-radios--inline">

                        <div class="nhsuk-radios__item">
                            <input class="nhsuk-radios__input" id="example-inline-5" name="example-inline-2" type="radio" value="yes">
                            <label class="nhsuk-label nhsuk-radios__label" for="example-inline-5">
                                Yes
                            </label>
                        </div>

                        <div class="nhsuk-radios__item">
                            <input class="nhsuk-radios__input" id="example-inline-6" name="example-inline-2" type="radio" value="no">
                            <label class="nhsuk-label nhsuk-radios__label" for="example-inline-6">
                                No
                            </label>
                        </div>

                    </div>
                </fieldset>
                </div>

            </div>

            <a class="nhsuk-button nhsuk-button--primary nhsuk-u-margin-top-3 nhsuk-u-margin-bottom-6" id="update-button" href="main-suppliers"
               onclick="storeUpdateCorrespondence()">Update correspondence</a>

            <a class="nhsuk-button nhsuk-button--primary nhsuk-u-margin-top-3 nhsuk-u-margin-bottom-6 hide-question" id="reset-button"
               onclick="resetCorrespondence()" href="#">Reset correspondence (not included in development)</a>
                        </div>
                    </div>



    <div class="nhsuk-tabs__panel" id="tab-contact" role="tabpanel" tabindex="-1"
         aria-labelledby="tab2">
        <div class="nhsuk-tabs-panel-inner">
                    <h2>Contact details</h2>

                    <table role="table" class="nhsuk-table-responsive primary-user-data nhsuk-u-margin-bottom-8" style="display: table;">
                        <caption class="nhsuk-table__caption">Supplier contacts</caption>
                        <thead role="rowgroup" class="nhsuk-table__head">
                        <tr role="row">
                            <th role="columnheader" class="" scope="col">
                                Name
                            </th>
                            <th role="columnheader" class="" scope="col">
                                Email
                            </th>
                            <th role="columnheader" class="" scope="col">
                                Phone number
                            </th>
                            <th>Contact level</th>
                        </tr>
                        </thead>
                        <tbody class="nhsuk-table__body">
                        <tr role="row" class="nhsuk-table__row">
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Name </span>Jane Smith
                            </td>
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Email </span>jane.smith@nhs.net
                            </td>
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Phone number </span>07700 900362
                            </td>
                            <td><strong class="nhsuk-tag nhsuk-tag--blue">
                                Primary
                            </strong></td>
                        </tr>
                        <tr role="row" class="nhsuk-table__row">
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Name </span>David Jones
                            </td>
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Email </span>david.jones@nhs.net
                            </td>
                            <td role="cell" class="nhsuk-table__cell">
                                <span class="nhsuk-table-responsive__heading">Phone number </span>07700 905456
                            </td>
                            <td><strong class="nhsuk-tag nhsuk-tag--grey">
                                Secondary
                            </strong></td>
                        </tr>
                        </tbody>
                    </table>

                    <h3>Specific supplier detail</h3>
                    <p>Specific notes relevant to the supplier goes here.</p>

                            </div>
                        </div>
                    </div>

<script>
    window.onload = function() {
    if (localStorage.getItem("go-back-supplier") == "main") {
    document.getElementById("back-link").setAttribute('href', "main-suppliers");
    document.getElementById("back-link").innerHTML = "<svg class='nhsuk-icon nhsuk-icon__chevron-left' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' aria-hidden='true' height='24' width='24'><path d='M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z'></path></svg>Go back to main suppliers";
       }
    };

    console.log(localStorage);

    var radioHasSentEmailButtons = document.getElementsByName("example-inline");
    let sentEmail = localStorage.getItem("has-sent-email");

    if (radioHasSentEmailButtons.length != 0) {


    for (var radio of radioHasSentEmailButtons) {
      if (sentEmail === radio.value) {
        radio.checked = true;
      }
    }
   }

        var monthNames = ["January", "February", "March", "April", "May","June","July", "August", "September", "October", "November","December"];

        var d = new Date();
        var dayToday = d.getDate();
        var monthToday = monthNames[d.getMonth()];
        var yearToday = d.getFullYear();

        replyDate = dayToday + ' ' + monthToday + ' ' + yearToday;

   if (sentEmail == "yes") {

      document.getElementById("second-question").classList.remove("hide-question");
      document.getElementById("first-question").classList.add("hide-question");
<!--      document.getElementById("yes-first-question-detail").innerHTML = 'Yes. The template was emailed to the supplier by Heather (HEKIR) on ' + replyDate + ' at 2pm.';-->
<!--      document.getElementById("yes-first-question").innerHTML = 'Template sent to the supplier on ' + replyDate;-->
      document.getElementById("yes-first-question-expander").classList.remove("hide-question");

   }

   var radioHasReceivedEmailButtons = document.getElementsByName("example-inline-1");
    let emailReceived = localStorage.getItem("supplier-has-replied");

    if (radioHasReceivedEmailButtons.length != 0) {


    for (var radio of radioHasReceivedEmailButtons) {
      if (emailReceived === radio.value) {
        radio.checked = true;
      }
    }
   }

   if (emailReceived == "yes") {
      document.getElementById("second-question").classList.add("hide-question");

      document.getElementById("template-sent-list").insertAdjacentHTML("afterend",
      '<div class="nhsuk-summary-list__row">'
      +
      '<dt class="nhsuk-summary-list__key">Reply received by</dt>'
      +
      '<dd class="nhsuk-summary-list__value">Laura Heslop (LAHES)</dd>'
      +
      '</div>'
      +
      '<div class="nhsuk-summary-list__row">'
      +
      '<dt class="nhsuk-summary-list__key">Date reply sent</dt>'
      +
      '<dd class="nhsuk-summary-list__value">12 October 2023 at 4pm</dd>'
      +
      '</div>');

<!--      document.getElementById("yes-second-question").innerHTML = 'Reply received from the supplier on ' + replyDate;-->
<!--      document.getElementById("yes-second-question-detail").innerHTML = 'Yes. An email has been received from the supplier by Heather (HEKIR) on ' + replyDate + ' at 3.30pm.';-->
<!--      document.getElementById("yes-second-question-expander").classList.remove("hide-question");-->
      document.getElementById("update-button").classList.add("hide-question");
      document.getElementById("reset-button").classList.remove("hide-question");
   }

   var radioHasSentReminderButtons = document.getElementsByName("example-inline-2");
    let reminderSent = localStorage.getItem("reminder-sent");

<!--    if (radioHasSentReminderButtons.length != 0) {-->

<!--    for (var radio of radioHasSentReminderButtons) {-->
<!--      if (reminderSent === radio.value) {-->
<!--        radio.checked = true;-->
<!--      }-->
<!--    }-->
<!--   }-->

   if (reminderSent == "yes") {

      document.getElementById("reminder-sent-question").innerHTML = "Have you sent another reminder to the supplier for a response?";



      document.getElementById("template-sent-list").insertAdjacentHTML("afterend",
      '<div class="nhsuk-summary-list__row">'
      +
      '<dt class="nhsuk-summary-list__key">Reminder sent by</dt>'
      +
      '<dd class="nhsuk-summary-list__value">Laura Heslop (LAHES)</dd>'
      +
      '</div>'
      +
      '<div class="nhsuk-summary-list__row">'
      +
      '<dt class="nhsuk-summary-list__key">Date reminder sent</dt>'
      +
      '<dd class="nhsuk-summary-list__value">12 October 2023 at 4pm</dd>'
      +
      '</div>');

<!--      document.getElementById("yes-second-question").innerHTML = 'Reply received from the supplier on ' + replyDate;-->
<!--      document.getElementById("yes-second-question-detail").innerHTML = 'Yes. An email has been received from the supplier by Heather (HEKIR) on ' + replyDate + ' at 3.30pm.';-->
<!--      document.getElementById("yes-second-question-expander").classList.remove("hide-question");-->
      document.getElementById("update-button").classList.add("hide-question");
      document.getElementById("reset-button").classList.remove("hide-question");
   }


  function storeUpdateCorrespondence() {

  var radioHasSentEmailButtonsX = document.getElementsByName("example-inline");
  var radioHasSentEmailButtonsY = document.getElementsByName("example-inline-1");
  var radioHasSentEmailButtonsZ = document.getElementsByName("example-inline-2");

  let today = new Date();

    for (var radio of radioHasSentEmailButtonsX) {
      if (radio.checked) {
        localStorage.setItem("has-sent-email", radio.value);
        localStorage.setItem("date-sent-email", today);
       if (radio.value == 'no') {
          localStorage.removeItem("date-sent-email");
       }
     }
    }

    for (var radio of radioHasSentEmailButtonsY) {
      if (radio.checked) {
        localStorage.setItem("supplier-has-replied", radio.value);
        localStorage.setItem("date-supplier-replied", today);
       if (radio.value == 'no') {
          localStorage.removeItem("date-supplier-replied");
       }
     }
    }

    for (var radio of radioHasSentEmailButtonsZ) {
      if (radio.checked) {
        localStorage.setItem("reminder-sent", radio.value);
        localStorage.setItem("date-reminder-sent", today);
       if (radio.value == 'no') {
          localStorage.removeItem("date-reminder-sent");
       }
     }
    }
   };

   function resetCorrespondence() {
   localStorage.clear();
   location.reload();

   }

</script>

{% endblock %}